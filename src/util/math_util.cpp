/*
 * math.cpp
 *
 *  Created on: Sep 5, 2017
 *      Author: harper
 */

#include <immintrin.h>
#include <stdint.h>
#include "template.h"
#include "math_util.h"

const __m128i hmask128 = _mm_setr_epi32(0, 0x80000000, 0, 0x80000000);
const __m128i zero128 = _mm_set1_epi32(0);
const __m128i lmask128 = _mm_setr_epi32(-1, 0x7fffffff, -1, 0x7fffffff);

const __m256i hmask256 = _mm256_setr_epi32(0, 0x80000000, 0, 0x80000000, 0,
                                           0x80000000, 0, 0x80000000);
const __m256i zero256 = _mm256_set1_epi32(0);
const __m256i lmask256 = _mm256_setr_epi32(-1, 0x7fffffff, -1, 0x7fffffff, -1,
                                           0x7fffffff, -1, 0x7fffffff);
const __m128i carry128 = _mm_setr_epi32(0, 0, 1, 0);

const __m256i carry256 = _mm256_setr_epi64x(0, 1, 1, 1);

const __m512i carry512 = _mm512_setr_epi64(0, 1, 1, 1, 1, 1, 1, 1);

__m128i mm_cmpgt_epu64(__m128i a, __m128i b) {
    __m128i ah = _mm_and_si128(a, hmask128);
    __m128i al = _mm_and_si128(a, lmask128);
    __m128i bh = _mm_and_si128(b, hmask128);
    __m128i bl = _mm_and_si128(b, lmask128);

    __m128i ahebh = _mm_cmpeq_epi64(ah, bh);
    __m128i algbl = _mm_cmpgt_epi64(al, bl);
    __m128i ahgbh = _mm_and_si128(_mm_cmpeq_epi64(ah, hmask128),
                                  _mm_cmpeq_epi64(bh, zero128));
    return _mm_or_si128(_mm_and_si128(ahebh, algbl), ahgbh);
}

__m256i mm256_cmpgt_epu64(__m256i a, __m256i b) {
    __m256i ah = _mm256_and_si256(a, hmask256);
    __m256i al = _mm256_and_si256(a, lmask256);
    __m256i bh = _mm256_and_si256(b, hmask256);
    __m256i bl = _mm256_and_si256(b, lmask256);

    __m256i ahebh = _mm256_cmpeq_epi64(ah, bh);
    __m256i algbl = _mm256_cmpgt_epi64(al, bl);
    __m256i ahgbh = _mm256_and_si256(_mm256_cmpeq_epi64(ah, hmask256),
                                     _mm256_cmpeq_epi64(bh, zero256));
    return _mm256_or_si256(_mm256_and_si256(ahebh, algbl), ahgbh);
}

__m128i mm_add_epi128(__m128i a, __m128i b) {
    __m128i result = _mm_add_epi64(a, b);
    int carry = _mm_cmp_epu64_mask(a, result, _MM_CMPINT_NLE);
    return (carry & 1) ? _mm_add_epi64(result, carry128) : result;
}

__m128i mm_add_epi128_2(__m128i a, __m128i b) {
    __m128i result = _mm_add_epi64(a, b);
    __m128i result1 = _mm_add_epi64(result, carry128);
    __m128i carry = mm_cmpgt_epu64(a, result);
    carry = (__m128i) _mm_permute_pd((__m128d) carry, 1);
    result = _mm_blendv_epi8(result, result1, carry);
    return result;
}

const int BLEND_TABLE_128[] = {0, 2};

__m128i mm_add_epi128_3(__m128i a, __m128i b) {
    __m128i result = _mm_add_epi64(a, b);
    __m128i result1 = _mm_add_epi64(result, carry128);
    __m128i carry = mm_cmpgt_epu64(a, result);
    int cbit = (_mm_extract_epi32(carry, 1) & 1);
    int blend = BLEND_TABLE_128[cbit];
    return (__m128i) mm_blend_pd((__m128d) result, (__m128d) result1, blend);
}

__m128i mm_add_epi128_1(__m128i a, __m128i b) {
    __m128i result = _mm_add_epi64(a, b);
    uint64_t r0 = (uint64_t) _mm_extract_epi64(result, 0);
    uint64_t a0 = (uint64_t) _mm_extract_epi64(a, 0);

    return (a0 > r0) ?
           _mm_add_epi64(result, carry128) : result;
}

__m128i mm_sub_epi128_1(__m128i a, __m128i b) {
    __m128i result = _mm_sub_epi64(a, b);
    __m128i carry = mm_cmpgt_epu64(result, a);
    carry = _mm_and_si128(carry,
                          _mm_setr_epi64(_mm_set_pi64x(1), _mm_set_pi64x(0)));
    carry = (__m128i) _mm_permute_pd((__m128d) carry, 1);
    result = _mm_sub_epi64(result, carry);
    return result;
}

__m128i mm_sub_epi128(__m128i a, __m128i b) {
    __m128i result = _mm_sub_epi64(a, b);
    uint64_t r0 = (uint64_t) _mm_extract_epi64(result, 0);
    uint64_t a0 = (uint64_t) _mm_extract_epi64(a, 0);
    return (r0 > a0) ?
           _mm_sub_epi64(result, carry128) : result;
}

const int BLEND_TABLE_256[] = {0, 2, 4, 2, 8, 10, 4, 10, 0, 6, 4, 6, 8, 6, 4,
                               6, 0, 2, 12, 2, 8, 10, 12, 10, 0, 14, 12, 14, 8, 14, 12, 14};

__m256i mm256_add_epi256_1(__m256i a, __m256i b) {
    __m256i result = _mm256_add_epi64(a, b);
    __m256i result1 = _mm256_add_epi64(result, carry256);

    uint64_t a2 = _mm256_extract_epi64(a, 2);
    uint64_t a3 = _mm256_extract_epi64(a, 1);
    uint64_t a4 = _mm256_extract_epi64(a, 0);

    int c21 = a2 > (uint64_t) _mm256_extract_epi64(result1, 2);
    int c31 = a3 > (uint64_t) _mm256_extract_epi64(result1, 1);
    int c2 = a2 > (uint64_t) _mm256_extract_epi64(result, 2);
    int c3 = a3 > (uint64_t) _mm256_extract_epi64(result, 1);
    int c4 = a4 > (uint64_t) _mm256_extract_epi64(result, 0);
    // The sequence is c2^1, c3^1, c2, c3, c4
    int blendIdx = c21 << 4 | c31 << 3 | c2 << 2 | c3 << 1 | c4;
    int blend = BLEND_TABLE_256[blendIdx];
    return (__m256i) mm256_blend_pd((__m256d) result, (__m256d) result1,
                                    blend);
}

__m256i mm256_add_epi256(__m256i a, __m256i b) {
    __m256i result = _mm256_add_epi64(a, b);
    __m256i result1 = _mm256_add_epi64(result, carry256);

    int carry = _mm256_cmp_epu64_mask(a, result, _MM_CMPINT_NLE);
    int carry1 = _mm256_cmp_epu64_mask(a, result1, _MM_CMPINT_NLE);

    // The sequence is c2^1, c3^1, c2, c3, c4
    int blendIdx = ((carry1 & 0x6) << 2) | (carry & 0x7);

    int blend = BLEND_TABLE_256[blendIdx];
    return (__m256i) mm256_blend_pd((__m256d) result, (__m256d) result1,
                                    blend);
}

__m256i mm256_add_epi256_2(__m256i a, __m256i b) {
    __m256i result = _mm256_add_epi64(a, b);
    __m256i result1 = _mm256_add_epi64(result, carry256);

    __m256i carry = mm256_cmpgt_epu64(a, result);
    __m256i carry1 = mm256_cmpgt_epu64(a, result1);

    // The sequence is c2^1, c3^1, c2, c3, c4
    __m256i maskedc = _mm256_and_si256(carry,
                                       _mm256_setr_epi64x(0x0101010101010101, 0x0202020202020202,
                                                          0x0404040404040404, 0));
    __m256i maskedc1 = _mm256_and_si256(carry1,
                                        _mm256_setr_epi64x(0, 0x0808080808080808, 0x1010101010101010, 0));
    __m256i cs = _mm256_add_epi64(maskedc, maskedc1);

    // Move data into 128 lane
    __m256i inlane = _mm256_permutevar8x32_epi32(cs,
                                                 _mm256_setr_epi32(0, 2, 4, 6, 6, 6, 6, 6));
    __m256i shuffle = _mm256_shuffle_epi8(inlane,
                                          _mm256_setr_epi64x(0xffffffffff080400, -1, -1, -1));

    int blendIdx = _mm256_extract_epi32(shuffle, 0);
    blendIdx = (blendIdx | (blendIdx >> 8) | (blendIdx >> 16)) & 0xff;
    int blend = BLEND_TABLE_256[blendIdx];
    return (__m256i) mm256_blend_pd((__m256d) result, (__m256d) result1,
                                    blend);
}



//const int BLEND_SUB_256[] = {0, 2, 4, 2, 8, 10, 4, 10, 0, 6, 4, 6, 8, 6, 4, 6, 0, 2, 12, 2, 8, 10, 12, 10, 0, 14, 12,
//                             14, 8, 14, 12, 14};

__m256i mm256_sub_epi256(__m256i a, __m256i b) {
    __m256i result = _mm256_sub_epi64(a, b);
    __m256i result1 = _mm256_sub_epi64(result, carry256);

    int carry = _mm256_cmp_epu64_mask(a, result, _MM_CMPINT_LT);
    int carry1 = _mm256_cmp_epu64_mask(a, result1, _MM_CMPINT_LT);

    int blendIdx = ((carry1 & 0x6) << 2) | (carry & 0x7);

    int blend = BLEND_TABLE_256[blendIdx];
    return (__m256i) mm256_blend_pd((__m256d) result, (__m256d) result1,
                                    blend);
}

__m256i mm256_sub_epi256_1(__m256i a, __m256i b) {
    __m256i result = _mm256_sub_epi64(a, b);
    __m256i result1 = _mm256_sub_epi64(result, carry256);

    uint64_t a0 = _mm256_extract_epi64(a, 0);
    uint64_t a1 = _mm256_extract_epi64(a, 1);
    uint64_t a2 = _mm256_extract_epi64(a, 2);

    int c2 = ((uint64_t) _mm256_extract_epi64(result, 2)) > a2;
    int c1 = ((uint64_t) _mm256_extract_epi64(result, 1)) > a1;
    int c0 = ((uint64_t) _mm256_extract_epi64(result, 0)) > a0;
    int c11 = ((uint64_t) _mm256_extract_epi64(result1, 1)) > a1;
    int c21 = ((uint64_t) _mm256_extract_epi64(result1, 2)) > a2;

    int blendIdx = c21 << 4 | c11 << 3 | c2 << 2 | c1 << 1 | c0;
    int blend = BLEND_TABLE_256[blendIdx];
    return (__m256i) mm256_blend_pd((__m256d) result, (__m256d) result1,
                                    blend);
}

int BLEND_TABLE_512[] = {0, 2, 4, 2, 8, 10, 4, 10, 0, 6, 4, 6, 8, 6, 4,
                         6, 0, 2, 12, 2, 8, 10, 12, 10, 0, 14, 12, 14, 8, 14, 12, 14,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 2, 4, 2, 8, 10, 4, 10, 0, 6, 4, 6, 8, 6, 4,
                         6, 0, 2, 12, 2, 8, 10, 12, 10, 0, 14, 12, 14, 8, 14, 12, 14,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 4, 2, 8, 10, 4, 10, 16, 18, 20, 18, 8, 10, 20, 10, 32,
                         34, 36, 34, 40, 42, 36, 42, 16, 18, 20, 18, 40, 42, 20, 42, 64, 66, 68, 66, 72, 74, 68, 74, 80,
                         82, 84, 82, 72, 74, 84, 74, 32, 34, 36, 34, 40, 42, 36, 42, 80, 82, 84, 82, 40, 42, 84, 42,
                         128, 130, 132, 130, 136, 138, 132, 138, 144, 146, 148, 146, 136, 138, 148, 138, 160, 162, 164,
                         162, 168, 170, 164, 170, 144, 146, 148, 146, 168, 170, 148, 170, 64, 66, 68, 66, 72, 74, 68,
                         74, 80, 82, 84, 82, 72, 74, 84, 74, 160, 162, 164, 162, 168, 170, 164, 170, 80, 82, 84, 82,
                         168, 170, 84, 170, 0, 6, 4, 6, 8, 6, 4, 6, 16, 22, 20, 22, 8, 22, 20, 22, 32, 38, 36, 38, 40,
                         38, 36, 38, 16, 22, 20, 22, 40, 22, 20, 22, 64, 70, 68, 70, 72, 70, 68, 70, 80, 86, 84, 86, 72,
                         86, 84, 86, 32, 38, 36, 38, 40, 38, 36, 38, 80, 86, 84, 86, 40, 86, 84, 86, 128, 134, 132, 134,
                         136, 134, 132, 134, 144, 150, 148, 150, 136, 150, 148, 150, 160, 166, 164, 166, 168, 166, 164,
                         166, 144, 150, 148, 150, 168, 150, 148, 150, 64, 70, 68, 70, 72, 70, 68, 70, 80, 86, 84, 86,
                         72, 86, 84, 86, 160, 166, 164, 166, 168, 166, 164, 166, 80, 86, 84, 86, 168, 86, 84, 86, 0, 2,
                         12, 2, 8, 10, 12, 10, 16, 18, 12, 18, 8, 10, 12, 10, 32, 34, 44, 34, 40, 42, 44, 42, 16, 18,
                         44, 18, 40, 42, 44, 42, 64, 66, 76, 66, 72, 74, 76, 74, 80, 82, 76, 82, 72, 74, 76, 74, 32, 34,
                         44, 34, 40, 42, 44, 42, 80, 82, 44, 82, 40, 42, 44, 42, 128, 130, 140, 130, 136, 138, 140, 138,
                         144, 146, 140, 146, 136, 138, 140, 138, 160, 162, 172, 162, 168, 170, 172, 170, 144, 146, 172,
                         146, 168, 170, 172, 170, 64, 66, 76, 66, 72, 74, 76, 74, 80, 82, 76, 82, 72, 74, 76, 74, 160,
                         162, 172, 162, 168, 170, 172, 170, 80, 82, 172, 82, 168, 170, 172, 170, 0, 14, 12, 14, 8, 14,
                         12, 14, 16, 14, 12, 14, 8, 14, 12, 14, 32, 46, 44, 46, 40, 46, 44, 46, 16, 46, 44, 46, 40, 46,
                         44, 46, 64, 78, 76, 78, 72, 78, 76, 78, 80, 78, 76, 78, 72, 78, 76, 78, 32, 46, 44, 46, 40, 46,
                         44, 46, 80, 46, 44, 46, 40, 46, 44, 46, 128, 142, 140, 142, 136, 142, 140, 142, 144, 142, 140,
                         142, 136, 142, 140, 142, 160, 174, 172, 174, 168, 174, 172, 174, 144, 174, 172, 174, 168, 174,
                         172, 174, 64, 78, 76, 78, 72, 78, 76, 78, 80, 78, 76, 78, 72, 78, 76, 78, 160, 174, 172, 174,
                         168, 174, 172, 174, 80, 174, 172, 174, 168, 174, 172, 174, 0, 2, 4, 2, 24, 26, 4, 26, 16, 18,
                         20, 18, 24, 26, 20, 26, 32, 34, 36, 34, 24, 26, 36, 26, 16, 18, 20, 18, 24, 26, 20, 26, 64, 66,
                         68, 66, 88, 90, 68, 90, 80, 82, 84, 82, 88, 90, 84, 90, 32, 34, 36, 34, 88, 90, 36, 90, 80, 82,
                         84, 82, 88, 90, 84, 90, 128, 130, 132, 130, 152, 154, 132, 154, 144, 146, 148, 146, 152, 154,
                         148, 154, 160, 162, 164, 162, 152, 154, 164, 154, 144, 146, 148, 146, 152, 154, 148, 154, 64,
                         66, 68, 66, 88, 90, 68, 90, 80, 82, 84, 82, 88, 90, 84, 90, 160, 162, 164, 162, 88, 90, 164,
                         90, 80, 82, 84, 82, 88, 90, 84, 90, 0, 6, 4, 6, 24, 6, 4, 6, 16, 22, 20, 22, 24, 22, 20, 22,
                         32, 38, 36, 38, 24, 38, 36, 38, 16, 22, 20, 22, 24, 22, 20, 22, 64, 70, 68, 70, 88, 70, 68, 70,
                         80, 86, 84, 86, 88, 86, 84, 86, 32, 38, 36, 38, 88, 38, 36, 38, 80, 86, 84, 86, 88, 86, 84, 86,
                         128, 134, 132, 134, 152, 134, 132, 134, 144, 150, 148, 150, 152, 150, 148, 150, 160, 166, 164,
                         166, 152, 166, 164, 166, 144, 150, 148, 150, 152, 150, 148, 150, 64, 70, 68, 70, 88, 70, 68,
                         70, 80, 86, 84, 86, 88, 86, 84, 86, 160, 166, 164, 166, 88, 166, 164, 166, 80, 86, 84, 86, 88,
                         86, 84, 86, 0, 2, 28, 2, 24, 26, 28, 26, 16, 18, 28, 18, 24, 26, 28, 26, 32, 34, 28, 34, 24,
                         26, 28, 26, 16, 18, 28, 18, 24, 26, 28, 26, 64, 66, 92, 66, 88, 90, 92, 90, 80, 82, 92, 82, 88,
                         90, 92, 90, 32, 34, 92, 34, 88, 90, 92, 90, 80, 82, 92, 82, 88, 90, 92, 90, 128, 130, 156, 130,
                         152, 154, 156, 154, 144, 146, 156, 146, 152, 154, 156, 154, 160, 162, 156, 162, 152, 154, 156,
                         154, 144, 146, 156, 146, 152, 154, 156, 154, 64, 66, 92, 66, 88, 90, 92, 90, 80, 82, 92, 82,
                         88, 90, 92, 90, 160, 162, 92, 162, 88, 90, 92, 90, 80, 82, 92, 82, 88, 90, 92, 90, 0, 30, 28,
                         30, 24, 30, 28, 30, 16, 30, 28, 30, 24, 30, 28, 30, 32, 30, 28, 30, 24, 30, 28, 30, 16, 30, 28,
                         30, 24, 30, 28, 30, 64, 94, 92, 94, 88, 94, 92, 94, 80, 94, 92, 94, 88, 94, 92, 94, 32, 94, 92,
                         94, 88, 94, 92, 94, 80, 94, 92, 94, 88, 94, 92, 94, 128, 158, 156, 158, 152, 158, 156, 158,
                         144, 158, 156, 158, 152, 158, 156, 158, 160, 158, 156, 158, 152, 158, 156, 158, 144, 158, 156,
                         158, 152, 158, 156, 158, 64, 94, 92, 94, 88, 94, 92, 94, 80, 94, 92, 94, 88, 94, 92, 94, 160,
                         94, 92, 94, 88, 94, 92, 94, 80, 94, 92, 94, 88, 94, 92, 94, 0, 2, 4, 2, 8, 10, 4, 10, 48, 50,
                         52, 50, 8, 10, 52, 10, 32, 34, 36, 34, 40, 42, 36, 42, 48, 50, 52, 50, 40, 42, 52, 42, 64, 66,
                         68, 66, 72, 74, 68, 74, 48, 50, 52, 50, 72, 74, 52, 74, 32, 34, 36, 34, 40, 42, 36, 42, 48, 50,
                         52, 50, 40, 42, 52, 42, 128, 130, 132, 130, 136, 138, 132, 138, 176, 178, 180, 178, 136, 138,
                         180, 138, 160, 162, 164, 162, 168, 170, 164, 170, 176, 178, 180, 178, 168, 170, 180, 170, 64,
                         66, 68, 66, 72, 74, 68, 74, 176, 178, 180, 178, 72, 74, 180, 74, 160, 162, 164, 162, 168, 170,
                         164, 170, 176, 178, 180, 178, 168, 170, 180, 170, 0, 6, 4, 6, 8, 6, 4, 6, 48, 54, 52, 54, 8,
                         54, 52, 54, 32, 38, 36, 38, 40, 38, 36, 38, 48, 54, 52, 54, 40, 54, 52, 54, 64, 70, 68, 70, 72,
                         70, 68, 70, 48, 54, 52, 54, 72, 54, 52, 54, 32, 38, 36, 38, 40, 38, 36, 38, 48, 54, 52, 54, 40,
                         54, 52, 54, 128, 134, 132, 134, 136, 134, 132, 134, 176, 182, 180, 182, 136, 182, 180, 182,
                         160, 166, 164, 166, 168, 166, 164, 166, 176, 182, 180, 182, 168, 182, 180, 182, 64, 70, 68, 70,
                         72, 70, 68, 70, 176, 182, 180, 182, 72, 182, 180, 182, 160, 166, 164, 166, 168, 166, 164, 166,
                         176, 182, 180, 182, 168, 182, 180, 182, 0, 2, 12, 2, 8, 10, 12, 10, 48, 50, 12, 50, 8, 10, 12,
                         10, 32, 34, 44, 34, 40, 42, 44, 42, 48, 50, 44, 50, 40, 42, 44, 42, 64, 66, 76, 66, 72, 74, 76,
                         74, 48, 50, 76, 50, 72, 74, 76, 74, 32, 34, 44, 34, 40, 42, 44, 42, 48, 50, 44, 50, 40, 42, 44,
                         42, 128, 130, 140, 130, 136, 138, 140, 138, 176, 178, 140, 178, 136, 138, 140, 138, 160, 162,
                         172, 162, 168, 170, 172, 170, 176, 178, 172, 178, 168, 170, 172, 170, 64, 66, 76, 66, 72, 74,
                         76, 74, 176, 178, 76, 178, 72, 74, 76, 74, 160, 162, 172, 162, 168, 170, 172, 170, 176, 178,
                         172, 178, 168, 170, 172, 170, 0, 14, 12, 14, 8, 14, 12, 14, 48, 14, 12, 14, 8, 14, 12, 14, 32,
                         46, 44, 46, 40, 46, 44, 46, 48, 46, 44, 46, 40, 46, 44, 46, 64, 78, 76, 78, 72, 78, 76, 78, 48,
                         78, 76, 78, 72, 78, 76, 78, 32, 46, 44, 46, 40, 46, 44, 46, 48, 46, 44, 46, 40, 46, 44, 46,
                         128, 142, 140, 142, 136, 142, 140, 142, 176, 142, 140, 142, 136, 142, 140, 142, 160, 174, 172,
                         174, 168, 174, 172, 174, 176, 174, 172, 174, 168, 174, 172, 174, 64, 78, 76, 78, 72, 78, 76,
                         78, 176, 78, 76, 78, 72, 78, 76, 78, 160, 174, 172, 174, 168, 174, 172, 174, 176, 174, 172,
                         174, 168, 174, 172, 174, 0, 2, 4, 2, 56, 58, 4, 58, 48, 50, 52, 50, 56, 58, 52, 58, 32, 34, 36,
                         34, 56, 58, 36, 58, 48, 50, 52, 50, 56, 58, 52, 58, 64, 66, 68, 66, 56, 58, 68, 58, 48, 50, 52,
                         50, 56, 58, 52, 58, 32, 34, 36, 34, 56, 58, 36, 58, 48, 50, 52, 50, 56, 58, 52, 58, 128, 130,
                         132, 130, 184, 186, 132, 186, 176, 178, 180, 178, 184, 186, 180, 186, 160, 162, 164, 162, 184,
                         186, 164, 186, 176, 178, 180, 178, 184, 186, 180, 186, 64, 66, 68, 66, 184, 186, 68, 186, 176,
                         178, 180, 178, 184, 186, 180, 186, 160, 162, 164, 162, 184, 186, 164, 186, 176, 178, 180, 178,
                         184, 186, 180, 186, 0, 6, 4, 6, 56, 6, 4, 6, 48, 54, 52, 54, 56, 54, 52, 54, 32, 38, 36, 38,
                         56, 38, 36, 38, 48, 54, 52, 54, 56, 54, 52, 54, 64, 70, 68, 70, 56, 70, 68, 70, 48, 54, 52, 54,
                         56, 54, 52, 54, 32, 38, 36, 38, 56, 38, 36, 38, 48, 54, 52, 54, 56, 54, 52, 54, 128, 134, 132,
                         134, 184, 134, 132, 134, 176, 182, 180, 182, 184, 182, 180, 182, 160, 166, 164, 166, 184, 166,
                         164, 166, 176, 182, 180, 182, 184, 182, 180, 182, 64, 70, 68, 70, 184, 70, 68, 70, 176, 182,
                         180, 182, 184, 182, 180, 182, 160, 166, 164, 166, 184, 166, 164, 166, 176, 182, 180, 182, 184,
                         182, 180, 182, 0, 2, 60, 2, 56, 58, 60, 58, 48, 50, 60, 50, 56, 58, 60, 58, 32, 34, 60, 34, 56,
                         58, 60, 58, 48, 50, 60, 50, 56, 58, 60, 58, 64, 66, 60, 66, 56, 58, 60, 58, 48, 50, 60, 50, 56,
                         58, 60, 58, 32, 34, 60, 34, 56, 58, 60, 58, 48, 50, 60, 50, 56, 58, 60, 58, 128, 130, 188, 130,
                         184, 186, 188, 186, 176, 178, 188, 178, 184, 186, 188, 186, 160, 162, 188, 162, 184, 186, 188,
                         186, 176, 178, 188, 178, 184, 186, 188, 186, 64, 66, 188, 66, 184, 186, 188, 186, 176, 178,
                         188, 178, 184, 186, 188, 186, 160, 162, 188, 162, 184, 186, 188, 186, 176, 178, 188, 178, 184,
                         186, 188, 186, 0, 62, 60, 62, 56, 62, 60, 62, 48, 62, 60, 62, 56, 62, 60, 62, 32, 62, 60, 62,
                         56, 62, 60, 62, 48, 62, 60, 62, 56, 62, 60, 62, 64, 62, 60, 62, 56, 62, 60, 62, 48, 62, 60, 62,
                         56, 62, 60, 62, 32, 62, 60, 62, 56, 62, 60, 62, 48, 62, 60, 62, 56, 62, 60, 62, 128, 190, 188,
                         190, 184, 190, 188, 190, 176, 190, 188, 190, 184, 190, 188, 190, 160, 190, 188, 190, 184, 190,
                         188, 190, 176, 190, 188, 190, 184, 190, 188, 190, 64, 190, 188, 190, 184, 190, 188, 190, 176,
                         190, 188, 190, 184, 190, 188, 190, 160, 190, 188, 190, 184, 190, 188, 190, 176, 190, 188, 190,
                         184, 190, 188, 190, 0, 2, 4, 2, 8, 10, 4, 10, 16, 18, 20, 18, 8, 10, 20, 10, 96, 98, 100, 98,
                         104, 106, 100, 106, 16, 18, 20, 18, 104, 106, 20, 106, 64, 66, 68, 66, 72, 74, 68, 74, 80, 82,
                         84, 82, 72, 74, 84, 74, 96, 98, 100, 98, 104, 106, 100, 106, 80, 82, 84, 82, 104, 106, 84, 106,
                         128, 130, 132, 130, 136, 138, 132, 138, 144, 146, 148, 146, 136, 138, 148, 138, 96, 98, 100,
                         98, 104, 106, 100, 106, 144, 146, 148, 146, 104, 106, 148, 106, 64, 66, 68, 66, 72, 74, 68, 74,
                         80, 82, 84, 82, 72, 74, 84, 74, 96, 98, 100, 98, 104, 106, 100, 106, 80, 82, 84, 82, 104, 106,
                         84, 106, 0, 6, 4, 6, 8, 6, 4, 6, 16, 22, 20, 22, 8, 22, 20, 22, 96, 102, 100, 102, 104, 102,
                         100, 102, 16, 22, 20, 22, 104, 22, 20, 22, 64, 70, 68, 70, 72, 70, 68, 70, 80, 86, 84, 86, 72,
                         86, 84, 86, 96, 102, 100, 102, 104, 102, 100, 102, 80, 86, 84, 86, 104, 86, 84, 86, 128, 134,
                         132, 134, 136, 134, 132, 134, 144, 150, 148, 150, 136, 150, 148, 150, 96, 102, 100, 102, 104,
                         102, 100, 102, 144, 150, 148, 150, 104, 150, 148, 150, 64, 70, 68, 70, 72, 70, 68, 70, 80, 86,
                         84, 86, 72, 86, 84, 86, 96, 102, 100, 102, 104, 102, 100, 102, 80, 86, 84, 86, 104, 86, 84, 86,
                         0, 2, 12, 2, 8, 10, 12, 10, 16, 18, 12, 18, 8, 10, 12, 10, 96, 98, 108, 98, 104, 106, 108, 106,
                         16, 18, 108, 18, 104, 106, 108, 106, 64, 66, 76, 66, 72, 74, 76, 74, 80, 82, 76, 82, 72, 74,
                         76, 74, 96, 98, 108, 98, 104, 106, 108, 106, 80, 82, 108, 82, 104, 106, 108, 106, 128, 130,
                         140, 130, 136, 138, 140, 138, 144, 146, 140, 146, 136, 138, 140, 138, 96, 98, 108, 98, 104,
                         106, 108, 106, 144, 146, 108, 146, 104, 106, 108, 106, 64, 66, 76, 66, 72, 74, 76, 74, 80, 82,
                         76, 82, 72, 74, 76, 74, 96, 98, 108, 98, 104, 106, 108, 106, 80, 82, 108, 82, 104, 106, 108,
                         106, 0, 14, 12, 14, 8, 14, 12, 14, 16, 14, 12, 14, 8, 14, 12, 14, 96, 110, 108, 110, 104, 110,
                         108, 110, 16, 110, 108, 110, 104, 110, 108, 110, 64, 78, 76, 78, 72, 78, 76, 78, 80, 78, 76,
                         78, 72, 78, 76, 78, 96, 110, 108, 110, 104, 110, 108, 110, 80, 110, 108, 110, 104, 110, 108,
                         110, 128, 142, 140, 142, 136, 142, 140, 142, 144, 142, 140, 142, 136, 142, 140, 142, 96, 110,
                         108, 110, 104, 110, 108, 110, 144, 110, 108, 110, 104, 110, 108, 110, 64, 78, 76, 78, 72, 78,
                         76, 78, 80, 78, 76, 78, 72, 78, 76, 78, 96, 110, 108, 110, 104, 110, 108, 110, 80, 110, 108,
                         110, 104, 110, 108, 110, 0, 2, 4, 2, 24, 26, 4, 26, 16, 18, 20, 18, 24, 26, 20, 26, 96, 98,
                         100, 98, 24, 26, 100, 26, 16, 18, 20, 18, 24, 26, 20, 26, 64, 66, 68, 66, 88, 90, 68, 90, 80,
                         82, 84, 82, 88, 90, 84, 90, 96, 98, 100, 98, 88, 90, 100, 90, 80, 82, 84, 82, 88, 90, 84, 90,
                         128, 130, 132, 130, 152, 154, 132, 154, 144, 146, 148, 146, 152, 154, 148, 154, 96, 98, 100,
                         98, 152, 154, 100, 154, 144, 146, 148, 146, 152, 154, 148, 154, 64, 66, 68, 66, 88, 90, 68, 90,
                         80, 82, 84, 82, 88, 90, 84, 90, 96, 98, 100, 98, 88, 90, 100, 90, 80, 82, 84, 82, 88, 90, 84,
                         90, 0, 6, 4, 6, 24, 6, 4, 6, 16, 22, 20, 22, 24, 22, 20, 22, 96, 102, 100, 102, 24, 102, 100,
                         102, 16, 22, 20, 22, 24, 22, 20, 22, 64, 70, 68, 70, 88, 70, 68, 70, 80, 86, 84, 86, 88, 86,
                         84, 86, 96, 102, 100, 102, 88, 102, 100, 102, 80, 86, 84, 86, 88, 86, 84, 86, 128, 134, 132,
                         134, 152, 134, 132, 134, 144, 150, 148, 150, 152, 150, 148, 150, 96, 102, 100, 102, 152, 102,
                         100, 102, 144, 150, 148, 150, 152, 150, 148, 150, 64, 70, 68, 70, 88, 70, 68, 70, 80, 86, 84,
                         86, 88, 86, 84, 86, 96, 102, 100, 102, 88, 102, 100, 102, 80, 86, 84, 86, 88, 86, 84, 86, 0, 2,
                         28, 2, 24, 26, 28, 26, 16, 18, 28, 18, 24, 26, 28, 26, 96, 98, 28, 98, 24, 26, 28, 26, 16, 18,
                         28, 18, 24, 26, 28, 26, 64, 66, 92, 66, 88, 90, 92, 90, 80, 82, 92, 82, 88, 90, 92, 90, 96, 98,
                         92, 98, 88, 90, 92, 90, 80, 82, 92, 82, 88, 90, 92, 90, 128, 130, 156, 130, 152, 154, 156, 154,
                         144, 146, 156, 146, 152, 154, 156, 154, 96, 98, 156, 98, 152, 154, 156, 154, 144, 146, 156,
                         146, 152, 154, 156, 154, 64, 66, 92, 66, 88, 90, 92, 90, 80, 82, 92, 82, 88, 90, 92, 90, 96,
                         98, 92, 98, 88, 90, 92, 90, 80, 82, 92, 82, 88, 90, 92, 90, 0, 30, 28, 30, 24, 30, 28, 30, 16,
                         30, 28, 30, 24, 30, 28, 30, 96, 30, 28, 30, 24, 30, 28, 30, 16, 30, 28, 30, 24, 30, 28, 30, 64,
                         94, 92, 94, 88, 94, 92, 94, 80, 94, 92, 94, 88, 94, 92, 94, 96, 94, 92, 94, 88, 94, 92, 94, 80,
                         94, 92, 94, 88, 94, 92, 94, 128, 158, 156, 158, 152, 158, 156, 158, 144, 158, 156, 158, 152,
                         158, 156, 158, 96, 158, 156, 158, 152, 158, 156, 158, 144, 158, 156, 158, 152, 158, 156, 158,
                         64, 94, 92, 94, 88, 94, 92, 94, 80, 94, 92, 94, 88, 94, 92, 94, 96, 94, 92, 94, 88, 94, 92, 94,
                         80, 94, 92, 94, 88, 94, 92, 94, 0, 2, 4, 2, 8, 10, 4, 10, 112, 114, 116, 114, 8, 10, 116, 10,
                         96, 98, 100, 98, 104, 106, 100, 106, 112, 114, 116, 114, 104, 106, 116, 106, 64, 66, 68, 66,
                         72, 74, 68, 74, 112, 114, 116, 114, 72, 74, 116, 74, 96, 98, 100, 98, 104, 106, 100, 106, 112,
                         114, 116, 114, 104, 106, 116, 106, 128, 130, 132, 130, 136, 138, 132, 138, 112, 114, 116, 114,
                         136, 138, 116, 138, 96, 98, 100, 98, 104, 106, 100, 106, 112, 114, 116, 114, 104, 106, 116,
                         106, 64, 66, 68, 66, 72, 74, 68, 74, 112, 114, 116, 114, 72, 74, 116, 74, 96, 98, 100, 98, 104,
                         106, 100, 106, 112, 114, 116, 114, 104, 106, 116, 106, 0, 6, 4, 6, 8, 6, 4, 6, 112, 118, 116,
                         118, 8, 118, 116, 118, 96, 102, 100, 102, 104, 102, 100, 102, 112, 118, 116, 118, 104, 118,
                         116, 118, 64, 70, 68, 70, 72, 70, 68, 70, 112, 118, 116, 118, 72, 118, 116, 118, 96, 102, 100,
                         102, 104, 102, 100, 102, 112, 118, 116, 118, 104, 118, 116, 118, 128, 134, 132, 134, 136, 134,
                         132, 134, 112, 118, 116, 118, 136, 118, 116, 118, 96, 102, 100, 102, 104, 102, 100, 102, 112,
                         118, 116, 118, 104, 118, 116, 118, 64, 70, 68, 70, 72, 70, 68, 70, 112, 118, 116, 118, 72, 118,
                         116, 118, 96, 102, 100, 102, 104, 102, 100, 102, 112, 118, 116, 118, 104, 118, 116, 118, 0, 2,
                         12, 2, 8, 10, 12, 10, 112, 114, 12, 114, 8, 10, 12, 10, 96, 98, 108, 98, 104, 106, 108, 106,
                         112, 114, 108, 114, 104, 106, 108, 106, 64, 66, 76, 66, 72, 74, 76, 74, 112, 114, 76, 114, 72,
                         74, 76, 74, 96, 98, 108, 98, 104, 106, 108, 106, 112, 114, 108, 114, 104, 106, 108, 106, 128,
                         130, 140, 130, 136, 138, 140, 138, 112, 114, 140, 114, 136, 138, 140, 138, 96, 98, 108, 98,
                         104, 106, 108, 106, 112, 114, 108, 114, 104, 106, 108, 106, 64, 66, 76, 66, 72, 74, 76, 74,
                         112, 114, 76, 114, 72, 74, 76, 74, 96, 98, 108, 98, 104, 106, 108, 106, 112, 114, 108, 114,
                         104, 106, 108, 106, 0, 14, 12, 14, 8, 14, 12, 14, 112, 14, 12, 14, 8, 14, 12, 14, 96, 110, 108,
                         110, 104, 110, 108, 110, 112, 110, 108, 110, 104, 110, 108, 110, 64, 78, 76, 78, 72, 78, 76,
                         78, 112, 78, 76, 78, 72, 78, 76, 78, 96, 110, 108, 110, 104, 110, 108, 110, 112, 110, 108, 110,
                         104, 110, 108, 110, 128, 142, 140, 142, 136, 142, 140, 142, 112, 142, 140, 142, 136, 142, 140,
                         142, 96, 110, 108, 110, 104, 110, 108, 110, 112, 110, 108, 110, 104, 110, 108, 110, 64, 78, 76,
                         78, 72, 78, 76, 78, 112, 78, 76, 78, 72, 78, 76, 78, 96, 110, 108, 110, 104, 110, 108, 110,
                         112, 110, 108, 110, 104, 110, 108, 110, 0, 2, 4, 2, 120, 122, 4, 122, 112, 114, 116, 114, 120,
                         122, 116, 122, 96, 98, 100, 98, 120, 122, 100, 122, 112, 114, 116, 114, 120, 122, 116, 122, 64,
                         66, 68, 66, 120, 122, 68, 122, 112, 114, 116, 114, 120, 122, 116, 122, 96, 98, 100, 98, 120,
                         122, 100, 122, 112, 114, 116, 114, 120, 122, 116, 122, 128, 130, 132, 130, 120, 122, 132, 122,
                         112, 114, 116, 114, 120, 122, 116, 122, 96, 98, 100, 98, 120, 122, 100, 122, 112, 114, 116,
                         114, 120, 122, 116, 122, 64, 66, 68, 66, 120, 122, 68, 122, 112, 114, 116, 114, 120, 122, 116,
                         122, 96, 98, 100, 98, 120, 122, 100, 122, 112, 114, 116, 114, 120, 122, 116, 122, 0, 6, 4, 6,
                         120, 6, 4, 6, 112, 118, 116, 118, 120, 118, 116, 118, 96, 102, 100, 102, 120, 102, 100, 102,
                         112, 118, 116, 118, 120, 118, 116, 118, 64, 70, 68, 70, 120, 70, 68, 70, 112, 118, 116, 118,
                         120, 118, 116, 118, 96, 102, 100, 102, 120, 102, 100, 102, 112, 118, 116, 118, 120, 118, 116,
                         118, 128, 134, 132, 134, 120, 134, 132, 134, 112, 118, 116, 118, 120, 118, 116, 118, 96, 102,
                         100, 102, 120, 102, 100, 102, 112, 118, 116, 118, 120, 118, 116, 118, 64, 70, 68, 70, 120, 70,
                         68, 70, 112, 118, 116, 118, 120, 118, 116, 118, 96, 102, 100, 102, 120, 102, 100, 102, 112,
                         118, 116, 118, 120, 118, 116, 118, 0, 2, 124, 2, 120, 122, 124, 122, 112, 114, 124, 114, 120,
                         122, 124, 122, 96, 98, 124, 98, 120, 122, 124, 122, 112, 114, 124, 114, 120, 122, 124, 122, 64,
                         66, 124, 66, 120, 122, 124, 122, 112, 114, 124, 114, 120, 122, 124, 122, 96, 98, 124, 98, 120,
                         122, 124, 122, 112, 114, 124, 114, 120, 122, 124, 122, 128, 130, 124, 130, 120, 122, 124, 122,
                         112, 114, 124, 114, 120, 122, 124, 122, 96, 98, 124, 98, 120, 122, 124, 122, 112, 114, 124,
                         114, 120, 122, 124, 122, 64, 66, 124, 66, 120, 122, 124, 122, 112, 114, 124, 114, 120, 122,
                         124, 122, 96, 98, 124, 98, 120, 122, 124, 122, 112, 114, 124, 114, 120, 122, 124, 122, 0, 126,
                         124, 126, 120, 126, 124, 126, 112, 126, 124, 126, 120, 126, 124, 126, 96, 126, 124, 126, 120,
                         126, 124, 126, 112, 126, 124, 126, 120, 126, 124, 126, 64, 126, 124, 126, 120, 126, 124, 126,
                         112, 126, 124, 126, 120, 126, 124, 126, 96, 126, 124, 126, 120, 126, 124, 126, 112, 126, 124,
                         126, 120, 126, 124, 126, 128, 126, 124, 126, 120, 126, 124, 126, 112, 126, 124, 126, 120, 126,
                         124, 126, 96, 126, 124, 126, 120, 126, 124, 126, 112, 126, 124, 126, 120, 126, 124, 126, 64,
                         126, 124, 126, 120, 126, 124, 126, 112, 126, 124, 126, 120, 126, 124, 126, 96, 126, 124, 126,
                         120, 126, 124, 126, 112, 126, 124, 126, 120, 126, 124, 126, 0, 2, 4, 2, 8, 10, 4, 10, 16, 18,
                         20, 18, 8, 10, 20, 10, 32, 34, 36, 34, 40, 42, 36, 42, 16, 18, 20, 18, 40, 42, 20, 42, 192,
                         194, 196, 194, 200, 202, 196, 202, 208, 210, 212, 210, 200, 202, 212, 202, 32, 34, 36, 34, 40,
                         42, 36, 42, 208, 210, 212, 210, 40, 42, 212, 42, 128, 130, 132, 130, 136, 138, 132, 138, 144,
                         146, 148, 146, 136, 138, 148, 138, 160, 162, 164, 162, 168, 170, 164, 170, 144, 146, 148, 146,
                         168, 170, 148, 170, 192, 194, 196, 194, 200, 202, 196, 202, 208, 210, 212, 210, 200, 202, 212,
                         202, 160, 162, 164, 162, 168, 170, 164, 170, 208, 210, 212, 210, 168, 170, 212, 170, 0, 6, 4,
                         6, 8, 6, 4, 6, 16, 22, 20, 22, 8, 22, 20, 22, 32, 38, 36, 38, 40, 38, 36, 38, 16, 22, 20, 22,
                         40, 22, 20, 22, 192, 198, 196, 198, 200, 198, 196, 198, 208, 214, 212, 214, 200, 214, 212, 214,
                         32, 38, 36, 38, 40, 38, 36, 38, 208, 214, 212, 214, 40, 214, 212, 214, 128, 134, 132, 134, 136,
                         134, 132, 134, 144, 150, 148, 150, 136, 150, 148, 150, 160, 166, 164, 166, 168, 166, 164, 166,
                         144, 150, 148, 150, 168, 150, 148, 150, 192, 198, 196, 198, 200, 198, 196, 198, 208, 214, 212,
                         214, 200, 214, 212, 214, 160, 166, 164, 166, 168, 166, 164, 166, 208, 214, 212, 214, 168, 214,
                         212, 214, 0, 2, 12, 2, 8, 10, 12, 10, 16, 18, 12, 18, 8, 10, 12, 10, 32, 34, 44, 34, 40, 42,
                         44, 42, 16, 18, 44, 18, 40, 42, 44, 42, 192, 194, 204, 194, 200, 202, 204, 202, 208, 210, 204,
                         210, 200, 202, 204, 202, 32, 34, 44, 34, 40, 42, 44, 42, 208, 210, 44, 210, 40, 42, 44, 42,
                         128, 130, 140, 130, 136, 138, 140, 138, 144, 146, 140, 146, 136, 138, 140, 138, 160, 162, 172,
                         162, 168, 170, 172, 170, 144, 146, 172, 146, 168, 170, 172, 170, 192, 194, 204, 194, 200, 202,
                         204, 202, 208, 210, 204, 210, 200, 202, 204, 202, 160, 162, 172, 162, 168, 170, 172, 170, 208,
                         210, 172, 210, 168, 170, 172, 170, 0, 14, 12, 14, 8, 14, 12, 14, 16, 14, 12, 14, 8, 14, 12, 14,
                         32, 46, 44, 46, 40, 46, 44, 46, 16, 46, 44, 46, 40, 46, 44, 46, 192, 206, 204, 206, 200, 206,
                         204, 206, 208, 206, 204, 206, 200, 206, 204, 206, 32, 46, 44, 46, 40, 46, 44, 46, 208, 46, 44,
                         46, 40, 46, 44, 46, 128, 142, 140, 142, 136, 142, 140, 142, 144, 142, 140, 142, 136, 142, 140,
                         142, 160, 174, 172, 174, 168, 174, 172, 174, 144, 174, 172, 174, 168, 174, 172, 174, 192, 206,
                         204, 206, 200, 206, 204, 206, 208, 206, 204, 206, 200, 206, 204, 206, 160, 174, 172, 174, 168,
                         174, 172, 174, 208, 174, 172, 174, 168, 174, 172, 174, 0, 2, 4, 2, 24, 26, 4, 26, 16, 18, 20,
                         18, 24, 26, 20, 26, 32, 34, 36, 34, 24, 26, 36, 26, 16, 18, 20, 18, 24, 26, 20, 26, 192, 194,
                         196, 194, 216, 218, 196, 218, 208, 210, 212, 210, 216, 218, 212, 218, 32, 34, 36, 34, 216, 218,
                         36, 218, 208, 210, 212, 210, 216, 218, 212, 218, 128, 130, 132, 130, 152, 154, 132, 154, 144,
                         146, 148, 146, 152, 154, 148, 154, 160, 162, 164, 162, 152, 154, 164, 154, 144, 146, 148, 146,
                         152, 154, 148, 154, 192, 194, 196, 194, 216, 218, 196, 218, 208, 210, 212, 210, 216, 218, 212,
                         218, 160, 162, 164, 162, 216, 218, 164, 218, 208, 210, 212, 210, 216, 218, 212, 218, 0, 6, 4,
                         6, 24, 6, 4, 6, 16, 22, 20, 22, 24, 22, 20, 22, 32, 38, 36, 38, 24, 38, 36, 38, 16, 22, 20, 22,
                         24, 22, 20, 22, 192, 198, 196, 198, 216, 198, 196, 198, 208, 214, 212, 214, 216, 214, 212, 214,
                         32, 38, 36, 38, 216, 38, 36, 38, 208, 214, 212, 214, 216, 214, 212, 214, 128, 134, 132, 134,
                         152, 134, 132, 134, 144, 150, 148, 150, 152, 150, 148, 150, 160, 166, 164, 166, 152, 166, 164,
                         166, 144, 150, 148, 150, 152, 150, 148, 150, 192, 198, 196, 198, 216, 198, 196, 198, 208, 214,
                         212, 214, 216, 214, 212, 214, 160, 166, 164, 166, 216, 166, 164, 166, 208, 214, 212, 214, 216,
                         214, 212, 214, 0, 2, 28, 2, 24, 26, 28, 26, 16, 18, 28, 18, 24, 26, 28, 26, 32, 34, 28, 34, 24,
                         26, 28, 26, 16, 18, 28, 18, 24, 26, 28, 26, 192, 194, 220, 194, 216, 218, 220, 218, 208, 210,
                         220, 210, 216, 218, 220, 218, 32, 34, 220, 34, 216, 218, 220, 218, 208, 210, 220, 210, 216,
                         218, 220, 218, 128, 130, 156, 130, 152, 154, 156, 154, 144, 146, 156, 146, 152, 154, 156, 154,
                         160, 162, 156, 162, 152, 154, 156, 154, 144, 146, 156, 146, 152, 154, 156, 154, 192, 194, 220,
                         194, 216, 218, 220, 218, 208, 210, 220, 210, 216, 218, 220, 218, 160, 162, 220, 162, 216, 218,
                         220, 218, 208, 210, 220, 210, 216, 218, 220, 218, 0, 30, 28, 30, 24, 30, 28, 30, 16, 30, 28,
                         30, 24, 30, 28, 30, 32, 30, 28, 30, 24, 30, 28, 30, 16, 30, 28, 30, 24, 30, 28, 30, 192, 222,
                         220, 222, 216, 222, 220, 222, 208, 222, 220, 222, 216, 222, 220, 222, 32, 222, 220, 222, 216,
                         222, 220, 222, 208, 222, 220, 222, 216, 222, 220, 222, 128, 158, 156, 158, 152, 158, 156, 158,
                         144, 158, 156, 158, 152, 158, 156, 158, 160, 158, 156, 158, 152, 158, 156, 158, 144, 158, 156,
                         158, 152, 158, 156, 158, 192, 222, 220, 222, 216, 222, 220, 222, 208, 222, 220, 222, 216, 222,
                         220, 222, 160, 222, 220, 222, 216, 222, 220, 222, 208, 222, 220, 222, 216, 222, 220, 222, 0, 2,
                         4, 2, 8, 10, 4, 10, 48, 50, 52, 50, 8, 10, 52, 10, 32, 34, 36, 34, 40, 42, 36, 42, 48, 50, 52,
                         50, 40, 42, 52, 42, 192, 194, 196, 194, 200, 202, 196, 202, 48, 50, 52, 50, 200, 202, 52, 202,
                         32, 34, 36, 34, 40, 42, 36, 42, 48, 50, 52, 50, 40, 42, 52, 42, 128, 130, 132, 130, 136, 138,
                         132, 138, 176, 178, 180, 178, 136, 138, 180, 138, 160, 162, 164, 162, 168, 170, 164, 170, 176,
                         178, 180, 178, 168, 170, 180, 170, 192, 194, 196, 194, 200, 202, 196, 202, 176, 178, 180, 178,
                         200, 202, 180, 202, 160, 162, 164, 162, 168, 170, 164, 170, 176, 178, 180, 178, 168, 170, 180,
                         170, 0, 6, 4, 6, 8, 6, 4, 6, 48, 54, 52, 54, 8, 54, 52, 54, 32, 38, 36, 38, 40, 38, 36, 38, 48,
                         54, 52, 54, 40, 54, 52, 54, 192, 198, 196, 198, 200, 198, 196, 198, 48, 54, 52, 54, 200, 54,
                         52, 54, 32, 38, 36, 38, 40, 38, 36, 38, 48, 54, 52, 54, 40, 54, 52, 54, 128, 134, 132, 134,
                         136, 134, 132, 134, 176, 182, 180, 182, 136, 182, 180, 182, 160, 166, 164, 166, 168, 166, 164,
                         166, 176, 182, 180, 182, 168, 182, 180, 182, 192, 198, 196, 198, 200, 198, 196, 198, 176, 182,
                         180, 182, 200, 182, 180, 182, 160, 166, 164, 166, 168, 166, 164, 166, 176, 182, 180, 182, 168,
                         182, 180, 182, 0, 2, 12, 2, 8, 10, 12, 10, 48, 50, 12, 50, 8, 10, 12, 10, 32, 34, 44, 34, 40,
                         42, 44, 42, 48, 50, 44, 50, 40, 42, 44, 42, 192, 194, 204, 194, 200, 202, 204, 202, 48, 50,
                         204, 50, 200, 202, 204, 202, 32, 34, 44, 34, 40, 42, 44, 42, 48, 50, 44, 50, 40, 42, 44, 42,
                         128, 130, 140, 130, 136, 138, 140, 138, 176, 178, 140, 178, 136, 138, 140, 138, 160, 162, 172,
                         162, 168, 170, 172, 170, 176, 178, 172, 178, 168, 170, 172, 170, 192, 194, 204, 194, 200, 202,
                         204, 202, 176, 178, 204, 178, 200, 202, 204, 202, 160, 162, 172, 162, 168, 170, 172, 170, 176,
                         178, 172, 178, 168, 170, 172, 170, 0, 14, 12, 14, 8, 14, 12, 14, 48, 14, 12, 14, 8, 14, 12, 14,
                         32, 46, 44, 46, 40, 46, 44, 46, 48, 46, 44, 46, 40, 46, 44, 46, 192, 206, 204, 206, 200, 206,
                         204, 206, 48, 206, 204, 206, 200, 206, 204, 206, 32, 46, 44, 46, 40, 46, 44, 46, 48, 46, 44,
                         46, 40, 46, 44, 46, 128, 142, 140, 142, 136, 142, 140, 142, 176, 142, 140, 142, 136, 142, 140,
                         142, 160, 174, 172, 174, 168, 174, 172, 174, 176, 174, 172, 174, 168, 174, 172, 174, 192, 206,
                         204, 206, 200, 206, 204, 206, 176, 206, 204, 206, 200, 206, 204, 206, 160, 174, 172, 174, 168,
                         174, 172, 174, 176, 174, 172, 174, 168, 174, 172, 174, 0, 2, 4, 2, 56, 58, 4, 58, 48, 50, 52,
                         50, 56, 58, 52, 58, 32, 34, 36, 34, 56, 58, 36, 58, 48, 50, 52, 50, 56, 58, 52, 58, 192, 194,
                         196, 194, 56, 58, 196, 58, 48, 50, 52, 50, 56, 58, 52, 58, 32, 34, 36, 34, 56, 58, 36, 58, 48,
                         50, 52, 50, 56, 58, 52, 58, 128, 130, 132, 130, 184, 186, 132, 186, 176, 178, 180, 178, 184,
                         186, 180, 186, 160, 162, 164, 162, 184, 186, 164, 186, 176, 178, 180, 178, 184, 186, 180, 186,
                         192, 194, 196, 194, 184, 186, 196, 186, 176, 178, 180, 178, 184, 186, 180, 186, 160, 162, 164,
                         162, 184, 186, 164, 186, 176, 178, 180, 178, 184, 186, 180, 186, 0, 6, 4, 6, 56, 6, 4, 6, 48,
                         54, 52, 54, 56, 54, 52, 54, 32, 38, 36, 38, 56, 38, 36, 38, 48, 54, 52, 54, 56, 54, 52, 54,
                         192, 198, 196, 198, 56, 198, 196, 198, 48, 54, 52, 54, 56, 54, 52, 54, 32, 38, 36, 38, 56, 38,
                         36, 38, 48, 54, 52, 54, 56, 54, 52, 54, 128, 134, 132, 134, 184, 134, 132, 134, 176, 182, 180,
                         182, 184, 182, 180, 182, 160, 166, 164, 166, 184, 166, 164, 166, 176, 182, 180, 182, 184, 182,
                         180, 182, 192, 198, 196, 198, 184, 198, 196, 198, 176, 182, 180, 182, 184, 182, 180, 182, 160,
                         166, 164, 166, 184, 166, 164, 166, 176, 182, 180, 182, 184, 182, 180, 182, 0, 2, 60, 2, 56, 58,
                         60, 58, 48, 50, 60, 50, 56, 58, 60, 58, 32, 34, 60, 34, 56, 58, 60, 58, 48, 50, 60, 50, 56, 58,
                         60, 58, 192, 194, 60, 194, 56, 58, 60, 58, 48, 50, 60, 50, 56, 58, 60, 58, 32, 34, 60, 34, 56,
                         58, 60, 58, 48, 50, 60, 50, 56, 58, 60, 58, 128, 130, 188, 130, 184, 186, 188, 186, 176, 178,
                         188, 178, 184, 186, 188, 186, 160, 162, 188, 162, 184, 186, 188, 186, 176, 178, 188, 178, 184,
                         186, 188, 186, 192, 194, 188, 194, 184, 186, 188, 186, 176, 178, 188, 178, 184, 186, 188, 186,
                         160, 162, 188, 162, 184, 186, 188, 186, 176, 178, 188, 178, 184, 186, 188, 186, 0, 62, 60, 62,
                         56, 62, 60, 62, 48, 62, 60, 62, 56, 62, 60, 62, 32, 62, 60, 62, 56, 62, 60, 62, 48, 62, 60, 62,
                         56, 62, 60, 62, 192, 62, 60, 62, 56, 62, 60, 62, 48, 62, 60, 62, 56, 62, 60, 62, 32, 62, 60,
                         62, 56, 62, 60, 62, 48, 62, 60, 62, 56, 62, 60, 62, 128, 190, 188, 190, 184, 190, 188, 190,
                         176, 190, 188, 190, 184, 190, 188, 190, 160, 190, 188, 190, 184, 190, 188, 190, 176, 190, 188,
                         190, 184, 190, 188, 190, 192, 190, 188, 190, 184, 190, 188, 190, 176, 190, 188, 190, 184, 190,
                         188, 190, 160, 190, 188, 190, 184, 190, 188, 190, 176, 190, 188, 190, 184, 190, 188, 190, 0, 2,
                         4, 2, 8, 10, 4, 10, 16, 18, 20, 18, 8, 10, 20, 10, 224, 226, 228, 226, 232, 234, 228, 234, 16,
                         18, 20, 18, 232, 234, 20, 234, 192, 194, 196, 194, 200, 202, 196, 202, 208, 210, 212, 210, 200,
                         202, 212, 202, 224, 226, 228, 226, 232, 234, 228, 234, 208, 210, 212, 210, 232, 234, 212, 234,
                         128, 130, 132, 130, 136, 138, 132, 138, 144, 146, 148, 146, 136, 138, 148, 138, 224, 226, 228,
                         226, 232, 234, 228, 234, 144, 146, 148, 146, 232, 234, 148, 234, 192, 194, 196, 194, 200, 202,
                         196, 202, 208, 210, 212, 210, 200, 202, 212, 202, 224, 226, 228, 226, 232, 234, 228, 234, 208,
                         210, 212, 210, 232, 234, 212, 234, 0, 6, 4, 6, 8, 6, 4, 6, 16, 22, 20, 22, 8, 22, 20, 22, 224,
                         230, 228, 230, 232, 230, 228, 230, 16, 22, 20, 22, 232, 22, 20, 22, 192, 198, 196, 198, 200,
                         198, 196, 198, 208, 214, 212, 214, 200, 214, 212, 214, 224, 230, 228, 230, 232, 230, 228, 230,
                         208, 214, 212, 214, 232, 214, 212, 214, 128, 134, 132, 134, 136, 134, 132, 134, 144, 150, 148,
                         150, 136, 150, 148, 150, 224, 230, 228, 230, 232, 230, 228, 230, 144, 150, 148, 150, 232, 150,
                         148, 150, 192, 198, 196, 198, 200, 198, 196, 198, 208, 214, 212, 214, 200, 214, 212, 214, 224,
                         230, 228, 230, 232, 230, 228, 230, 208, 214, 212, 214, 232, 214, 212, 214, 0, 2, 12, 2, 8, 10,
                         12, 10, 16, 18, 12, 18, 8, 10, 12, 10, 224, 226, 236, 226, 232, 234, 236, 234, 16, 18, 236, 18,
                         232, 234, 236, 234, 192, 194, 204, 194, 200, 202, 204, 202, 208, 210, 204, 210, 200, 202, 204,
                         202, 224, 226, 236, 226, 232, 234, 236, 234, 208, 210, 236, 210, 232, 234, 236, 234, 128, 130,
                         140, 130, 136, 138, 140, 138, 144, 146, 140, 146, 136, 138, 140, 138, 224, 226, 236, 226, 232,
                         234, 236, 234, 144, 146, 236, 146, 232, 234, 236, 234, 192, 194, 204, 194, 200, 202, 204, 202,
                         208, 210, 204, 210, 200, 202, 204, 202, 224, 226, 236, 226, 232, 234, 236, 234, 208, 210, 236,
                         210, 232, 234, 236, 234, 0, 14, 12, 14, 8, 14, 12, 14, 16, 14, 12, 14, 8, 14, 12, 14, 224, 238,
                         236, 238, 232, 238, 236, 238, 16, 238, 236, 238, 232, 238, 236, 238, 192, 206, 204, 206, 200,
                         206, 204, 206, 208, 206, 204, 206, 200, 206, 204, 206, 224, 238, 236, 238, 232, 238, 236, 238,
                         208, 238, 236, 238, 232, 238, 236, 238, 128, 142, 140, 142, 136, 142, 140, 142, 144, 142, 140,
                         142, 136, 142, 140, 142, 224, 238, 236, 238, 232, 238, 236, 238, 144, 238, 236, 238, 232, 238,
                         236, 238, 192, 206, 204, 206, 200, 206, 204, 206, 208, 206, 204, 206, 200, 206, 204, 206, 224,
                         238, 236, 238, 232, 238, 236, 238, 208, 238, 236, 238, 232, 238, 236, 238, 0, 2, 4, 2, 24, 26,
                         4, 26, 16, 18, 20, 18, 24, 26, 20, 26, 224, 226, 228, 226, 24, 26, 228, 26, 16, 18, 20, 18, 24,
                         26, 20, 26, 192, 194, 196, 194, 216, 218, 196, 218, 208, 210, 212, 210, 216, 218, 212, 218,
                         224, 226, 228, 226, 216, 218, 228, 218, 208, 210, 212, 210, 216, 218, 212, 218, 128, 130, 132,
                         130, 152, 154, 132, 154, 144, 146, 148, 146, 152, 154, 148, 154, 224, 226, 228, 226, 152, 154,
                         228, 154, 144, 146, 148, 146, 152, 154, 148, 154, 192, 194, 196, 194, 216, 218, 196, 218, 208,
                         210, 212, 210, 216, 218, 212, 218, 224, 226, 228, 226, 216, 218, 228, 218, 208, 210, 212, 210,
                         216, 218, 212, 218, 0, 6, 4, 6, 24, 6, 4, 6, 16, 22, 20, 22, 24, 22, 20, 22, 224, 230, 228,
                         230, 24, 230, 228, 230, 16, 22, 20, 22, 24, 22, 20, 22, 192, 198, 196, 198, 216, 198, 196, 198,
                         208, 214, 212, 214, 216, 214, 212, 214, 224, 230, 228, 230, 216, 230, 228, 230, 208, 214, 212,
                         214, 216, 214, 212, 214, 128, 134, 132, 134, 152, 134, 132, 134, 144, 150, 148, 150, 152, 150,
                         148, 150, 224, 230, 228, 230, 152, 230, 228, 230, 144, 150, 148, 150, 152, 150, 148, 150, 192,
                         198, 196, 198, 216, 198, 196, 198, 208, 214, 212, 214, 216, 214, 212, 214, 224, 230, 228, 230,
                         216, 230, 228, 230, 208, 214, 212, 214, 216, 214, 212, 214, 0, 2, 28, 2, 24, 26, 28, 26, 16,
                         18, 28, 18, 24, 26, 28, 26, 224, 226, 28, 226, 24, 26, 28, 26, 16, 18, 28, 18, 24, 26, 28, 26,
                         192, 194, 220, 194, 216, 218, 220, 218, 208, 210, 220, 210, 216, 218, 220, 218, 224, 226, 220,
                         226, 216, 218, 220, 218, 208, 210, 220, 210, 216, 218, 220, 218, 128, 130, 156, 130, 152, 154,
                         156, 154, 144, 146, 156, 146, 152, 154, 156, 154, 224, 226, 156, 226, 152, 154, 156, 154, 144,
                         146, 156, 146, 152, 154, 156, 154, 192, 194, 220, 194, 216, 218, 220, 218, 208, 210, 220, 210,
                         216, 218, 220, 218, 224, 226, 220, 226, 216, 218, 220, 218, 208, 210, 220, 210, 216, 218, 220,
                         218, 0, 30, 28, 30, 24, 30, 28, 30, 16, 30, 28, 30, 24, 30, 28, 30, 224, 30, 28, 30, 24, 30,
                         28, 30, 16, 30, 28, 30, 24, 30, 28, 30, 192, 222, 220, 222, 216, 222, 220, 222, 208, 222, 220,
                         222, 216, 222, 220, 222, 224, 222, 220, 222, 216, 222, 220, 222, 208, 222, 220, 222, 216, 222,
                         220, 222, 128, 158, 156, 158, 152, 158, 156, 158, 144, 158, 156, 158, 152, 158, 156, 158, 224,
                         158, 156, 158, 152, 158, 156, 158, 144, 158, 156, 158, 152, 158, 156, 158, 192, 222, 220, 222,
                         216, 222, 220, 222, 208, 222, 220, 222, 216, 222, 220, 222, 224, 222, 220, 222, 216, 222, 220,
                         222, 208, 222, 220, 222, 216, 222, 220, 222, 0, 2, 4, 2, 8, 10, 4, 10, 240, 242, 244, 242, 8,
                         10, 244, 10, 224, 226, 228, 226, 232, 234, 228, 234, 240, 242, 244, 242, 232, 234, 244, 234,
                         192, 194, 196, 194, 200, 202, 196, 202, 240, 242, 244, 242, 200, 202, 244, 202, 224, 226, 228,
                         226, 232, 234, 228, 234, 240, 242, 244, 242, 232, 234, 244, 234, 128, 130, 132, 130, 136, 138,
                         132, 138, 240, 242, 244, 242, 136, 138, 244, 138, 224, 226, 228, 226, 232, 234, 228, 234, 240,
                         242, 244, 242, 232, 234, 244, 234, 192, 194, 196, 194, 200, 202, 196, 202, 240, 242, 244, 242,
                         200, 202, 244, 202, 224, 226, 228, 226, 232, 234, 228, 234, 240, 242, 244, 242, 232, 234, 244,
                         234, 0, 6, 4, 6, 8, 6, 4, 6, 240, 246, 244, 246, 8, 246, 244, 246, 224, 230, 228, 230, 232,
                         230, 228, 230, 240, 246, 244, 246, 232, 246, 244, 246, 192, 198, 196, 198, 200, 198, 196, 198,
                         240, 246, 244, 246, 200, 246, 244, 246, 224, 230, 228, 230, 232, 230, 228, 230, 240, 246, 244,
                         246, 232, 246, 244, 246, 128, 134, 132, 134, 136, 134, 132, 134, 240, 246, 244, 246, 136, 246,
                         244, 246, 224, 230, 228, 230, 232, 230, 228, 230, 240, 246, 244, 246, 232, 246, 244, 246, 192,
                         198, 196, 198, 200, 198, 196, 198, 240, 246, 244, 246, 200, 246, 244, 246, 224, 230, 228, 230,
                         232, 230, 228, 230, 240, 246, 244, 246, 232, 246, 244, 246, 0, 2, 12, 2, 8, 10, 12, 10, 240,
                         242, 12, 242, 8, 10, 12, 10, 224, 226, 236, 226, 232, 234, 236, 234, 240, 242, 236, 242, 232,
                         234, 236, 234, 192, 194, 204, 194, 200, 202, 204, 202, 240, 242, 204, 242, 200, 202, 204, 202,
                         224, 226, 236, 226, 232, 234, 236, 234, 240, 242, 236, 242, 232, 234, 236, 234, 128, 130, 140,
                         130, 136, 138, 140, 138, 240, 242, 140, 242, 136, 138, 140, 138, 224, 226, 236, 226, 232, 234,
                         236, 234, 240, 242, 236, 242, 232, 234, 236, 234, 192, 194, 204, 194, 200, 202, 204, 202, 240,
                         242, 204, 242, 200, 202, 204, 202, 224, 226, 236, 226, 232, 234, 236, 234, 240, 242, 236, 242,
                         232, 234, 236, 234, 0, 14, 12, 14, 8, 14, 12, 14, 240, 14, 12, 14, 8, 14, 12, 14, 224, 238,
                         236, 238, 232, 238, 236, 238, 240, 238, 236, 238, 232, 238, 236, 238, 192, 206, 204, 206, 200,
                         206, 204, 206, 240, 206, 204, 206, 200, 206, 204, 206, 224, 238, 236, 238, 232, 238, 236, 238,
                         240, 238, 236, 238, 232, 238, 236, 238, 128, 142, 140, 142, 136, 142, 140, 142, 240, 142, 140,
                         142, 136, 142, 140, 142, 224, 238, 236, 238, 232, 238, 236, 238, 240, 238, 236, 238, 232, 238,
                         236, 238, 192, 206, 204, 206, 200, 206, 204, 206, 240, 206, 204, 206, 200, 206, 204, 206, 224,
                         238, 236, 238, 232, 238, 236, 238, 240, 238, 236, 238, 232, 238, 236, 238, 0, 2, 4, 2, 248,
                         250, 4, 250, 240, 242, 244, 242, 248, 250, 244, 250, 224, 226, 228, 226, 248, 250, 228, 250,
                         240, 242, 244, 242, 248, 250, 244, 250, 192, 194, 196, 194, 248, 250, 196, 250, 240, 242, 244,
                         242, 248, 250, 244, 250, 224, 226, 228, 226, 248, 250, 228, 250, 240, 242, 244, 242, 248, 250,
                         244, 250, 128, 130, 132, 130, 248, 250, 132, 250, 240, 242, 244, 242, 248, 250, 244, 250, 224,
                         226, 228, 226, 248, 250, 228, 250, 240, 242, 244, 242, 248, 250, 244, 250, 192, 194, 196, 194,
                         248, 250, 196, 250, 240, 242, 244, 242, 248, 250, 244, 250, 224, 226, 228, 226, 248, 250, 228,
                         250, 240, 242, 244, 242, 248, 250, 244, 250, 0, 6, 4, 6, 248, 6, 4, 6, 240, 246, 244, 246, 248,
                         246, 244, 246, 224, 230, 228, 230, 248, 230, 228, 230, 240, 246, 244, 246, 248, 246, 244, 246,
                         192, 198, 196, 198, 248, 198, 196, 198, 240, 246, 244, 246, 248, 246, 244, 246, 224, 230, 228,
                         230, 248, 230, 228, 230, 240, 246, 244, 246, 248, 246, 244, 246, 128, 134, 132, 134, 248, 134,
                         132, 134, 240, 246, 244, 246, 248, 246, 244, 246, 224, 230, 228, 230, 248, 230, 228, 230, 240,
                         246, 244, 246, 248, 246, 244, 246, 192, 198, 196, 198, 248, 198, 196, 198, 240, 246, 244, 246,
                         248, 246, 244, 246, 224, 230, 228, 230, 248, 230, 228, 230, 240, 246, 244, 246, 248, 246, 244,
                         246, 0, 2, 252, 2, 248, 250, 252, 250, 240, 242, 252, 242, 248, 250, 252, 250, 224, 226, 252,
                         226, 248, 250, 252, 250, 240, 242, 252, 242, 248, 250, 252, 250, 192, 194, 252, 194, 248, 250,
                         252, 250, 240, 242, 252, 242, 248, 250, 252, 250, 224, 226, 252, 226, 248, 250, 252, 250, 240,
                         242, 252, 242, 248, 250, 252, 250, 128, 130, 252, 130, 248, 250, 252, 250, 240, 242, 252, 242,
                         248, 250, 252, 250, 224, 226, 252, 226, 248, 250, 252, 250, 240, 242, 252, 242, 248, 250, 252,
                         250, 192, 194, 252, 194, 248, 250, 252, 250, 240, 242, 252, 242, 248, 250, 252, 250, 224, 226,
                         252, 226, 248, 250, 252, 250, 240, 242, 252, 242, 248, 250, 252, 250, 0, 254, 252, 254, 248,
                         254, 252, 254, 240, 254, 252, 254, 248, 254, 252, 254, 224, 254, 252, 254, 248, 254, 252, 254,
                         240, 254, 252, 254, 248, 254, 252, 254, 192, 254, 252, 254, 248, 254, 252, 254, 240, 254, 252,
                         254, 248, 254, 252, 254, 224, 254, 252, 254, 248, 254, 252, 254, 240, 254, 252, 254, 248, 254,
                         252, 254, 128, 254, 252, 254, 248, 254, 252, 254, 240, 254, 252, 254, 248, 254, 252, 254, 224,
                         254, 252, 254, 248, 254, 252, 254, 240, 254, 252, 254, 248, 254, 252, 254, 192, 254, 252, 254,
                         248, 254, 252, 254, 240, 254, 252, 254, 248, 254, 252, 254, 224, 254, 252, 254, 248, 254, 252,
                         254, 240, 254, 252, 254, 248, 254, 252, 254};

__m512i mm512_add_epi512(__m512i a, __m512i b) {
    __m512i result = _mm512_add_epi64(a, b);
    __m512i result1 = _mm512_add_epi64(result, carry512);

    int carry = _mm512_cmp_epu64_mask(a, result, _MM_CMPINT_NLE);
    int carry1 = _mm512_cmp_epu64_mask(a, result1, _MM_CMPINT_NLE);

    int blendIdx = ((carry1 & 0x7e) << 6) | (carry & 0x7f);

    int blend = BLEND_TABLE_512[blendIdx];
    return mm512_blend_epi64(result, result1, blend);
}

__m512i mm512_sub_epi512(__m512i a, __m512i b) {
    __m512i result = _mm512_sub_epi64(a, b);
    __m512i result1 = _mm512_sub_epi64(result, carry512);

    int carry = _mm512_cmp_epu64_mask(a, result, _MM_CMPINT_LT);
    int carry1 = _mm512_cmp_epu64_mask(a, result1, _MM_CMPINT_LT);

    int blendIdx = ((carry1 & 0x7e) << 6) | (carry & 0x7f);

    int blend = BLEND_TABLE_512[blendIdx];
    return mm512_blend_epi64(result, result1, blend);
}
